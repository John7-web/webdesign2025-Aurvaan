<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Saturn</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      min-height: 100%;
      overflow-x: hidden;
      background: #000;
      color: #ddd;
      font-family: system-ui, sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* 3D viewer container */
    #viewer {
      width: 100%;
      height: 62vh;
      min-height: 420px;
      position: relative;
      background: radial-gradient(ellipse at center, #030316 0%, #000 60%);
      overflow: hidden;
      transition: height 360ms ease;
    }

    #info {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      color: #ccc;
      font-size: 13px;
      opacity: 0.95;
      z-index: 10;
      text-align: center;
      pointer-events: none;
    }

    /* Research / content area */
    #content {
      max-width: 920px;
      margin: 24px auto 72px;
      padding: 20px 22px;
      background: rgba(255,255,255,0.02);
      border-radius: 8px;
      box-shadow: 0 6px 30px rgba(0,0,0,0.6);
      color: #ddd;
      line-height: 1.6;
    }

    #content h1, #content h2 { color: #fff; margin: 0.8rem 0 0.4rem; }
    #content p, #content ul { margin: 0.5rem 0; color: #cfd8dc; }
    #content ul { padding-left: 1.2rem; }
    #content small { color: #9ea7ab; }
  </style>
</head>
<body>
<div id="viewer">
  <div id="info">Saturn<br>Drag = rotate • Scroll = zoom</div>
</div>

<div id="content">
  <h1>Saturn — In-depth Overview</h1>
  <p>Saturn is the sixth planet from the Sun and a gas giant best known for its extensive ring system. This section summarizes Saturn's formation, internal structure, atmosphere, rings, moons, magnetosphere, and exploration history.</p>

  <h2>Formation & Evolution</h2>
  <p>Saturn formed about 4.5 billion years ago through accretion in the protoplanetary disk. Its large mass allowed rapid gas capture, forming a hydrogen-helium envelope and a system of rings and moons early in its history.</p>

  <h2>Internal Structure</h2>
  <p>Saturn likely has a dense core surrounded by metallic hydrogen and a molecular hydrogen envelope. Its low overall density suggests a large proportion of light gases compared with terrestrial planets.</p>

  <h2>Atmosphere & Weather</h2>
  <p>Saturn's atmosphere shows banded cloud structures, seasonal storms, and long-lived vortices. Clouds are composed of ammonia, ammonium hydrosulfide, and water ice at various depths.</p>

  <h2>Rings</h2>
  <p>Saturn's rings are composed of ice and rock particles ranging from micrometers to meters in size. The rings are dynamically active and structured by gravitational interactions with moons and ring–moonlets.</p>

  <h2>Moons</h2>
  <p>Saturn has over 80 confirmed moons, including Titan (with a thick nitrogen-rich atmosphere and surface lakes of hydrocarbons) and Enceladus (which has geysers venting water vapor and organic compounds).</p>

  <h2>Magnetosphere</h2>
  <p>Saturn's magnetic field interacts with its rings and moons, generating aurorae and shaping plasma environments. The magnetosphere is driven by planetary rotation and internal dynamics.</p>

  <h2>Exploration & Science</h2>
  <p>Saturn has been explored by Pioneer and Voyager flybys and extensively by the Cassini-Huygens mission, which transformed our understanding of the planet, rings, and moons.</p>

  <h2>Quick Facts</h2>
  <ul>
    <li>Mean radius: ~58,232 km</li>
    <li>Mass: ~5.68 × 10<sup>26</sup> kg</li>
    <li>Rotation period: ~10.7 hours</li>
    <li>Main atmospheric gas: H₂, He</li>
    <li>Number of known moons: 80+</li>
  </ul>

  <p><small>Sources: NASA Cassini mission, peer-reviewed planetary science literature.</small></p>
</div>

<!-- Three.js r124 (NO modules) -->
<script src="https://cdn.jsdelivr.net/npm/three@0.124.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.124.0/examples/js/controls/OrbitControls.js"></script>

<script>
  // ===================== SCENE =====================

  var scene = new THREE.Scene();

  var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 5000);
  camera.position.set(0, 3, 12);

  var viewer = document.getElementById('viewer');

  var renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(viewer.clientWidth, viewer.clientHeight);
  renderer.setPixelRatio(window.devicePixelRatio);
  renderer.outputEncoding = THREE.sRGBEncoding;
  renderer.domElement.style.display = 'block';
  viewer.appendChild(renderer.domElement);

  // Ensure camera uses viewer aspect ratio
  camera.aspect = viewer.clientWidth / viewer.clientHeight;
  camera.updateProjectionMatrix();

  var controls = new THREE.OrbitControls(camera, renderer.domElement);
  controls.enableDamping = true;
  controls.enablePan = false;

  // ===================== LIGHTING =====================

  var sunLight = new THREE.DirectionalLight(0xffffff, 2.5);
  sunLight.position.set(10, 0, 0); // safe default
  scene.add(sunLight);
  scene.add(new THREE.AmbientLight(0x111111));

  // ===================== SUN (CREATE FIRST, ALWAYS EXISTS) =====================

  var sun = new THREE.Mesh(
    new THREE.SphereGeometry(0, 0, 0),
    new THREE.MeshBasicMaterial({
      map: new THREE.TextureLoader().load('https://threejs.org/examples/textures/planets/sun.jpg')
    })
  );
  sun.position.set(10, 0, 0);
  scene.add(sun);

  // ===================== SATURN =====================

  var loader = new THREE.TextureLoader();

  var saturn = new THREE.Mesh(
    new THREE.SphereGeometry(1.8, 128, 128),
    new THREE.MeshPhongMaterial({
      map: loader.load('https://img2.cgtrader.com/items/23539/826d3ad99d/large/saturn-3d-model-blend.jpg'),
      shininess: 2
    })
  );
  saturn.rotation.z = THREE.Math.degToRad(26.7);
  scene.add(saturn);

  // ===================== SATURN RINGS (STABLE + VISIBLE) =====================

  var ringGeo = new THREE.RingGeometry(2.2, 3.9, 256);
  var ringMat = new THREE.MeshBasicMaterial({
    map: loader.load('https://tse4.mm.bing.net/th/id/OIP.pM8t8KZlIt-JDZEMey0t8AHaHa?cb=ucfimg2&ucfimg=1&rs=1&pid=ImgDetMain&o=7&rm=3'),
    side: THREE.DoubleSide
  });

  var rings = new THREE.Mesh(ringGeo, ringMat);
  rings.rotation.x = Math.PI / 2;
  rings.rotation.z = THREE.Math.degToRad(26.7);
  saturn.add(rings); // parented so it always renders

  // ===================== STARS =====================

  var starsGeo = new THREE.BufferGeometry();
  var starCount = 12000;
  var positions = new Float32Array(starCount * 3);

  for (var i = 0; i < starCount * 3; i++) {
    positions[i] = (Math.random() - 0.5) * 4000;
  }

  starsGeo.setAttribute('position', new THREE.BufferAttribute(positions, 3));

  var stars = new THREE.Points(
    starsGeo,
    new THREE.PointsMaterial({ color: 0xffffff, size: 0.7 })
  );
  scene.add(stars);

  // ===================== ASTRONOMY =====================

  var cycleStart = Date.now();
  var CYCLE_DURATION = 15000;

  function updateSun() {
    if (!sun || !sunLight) return; // hard safety guard

    var elapsed = (Date.now() - cycleStart) % CYCLE_DURATION;
    var angle = (elapsed / CYCLE_DURATION) * Math.PI * 2;

    var x = Math.cos(angle) * 12;
    var z = Math.sin(angle) * 12;

    sun.position.set(x, 0, z);
    sunLight.position.set(x, 0, z);
  }

  // ===================== RESIZE =====================

  window.addEventListener('resize', function () {
    renderer.setSize(viewer.clientWidth, viewer.clientHeight);
    camera.aspect = viewer.clientWidth / viewer.clientHeight;
    camera.updateProjectionMatrix();
  });

  // ===================== LOOP =====================

  function animate() {
    requestAnimationFrame(animate);

    saturn.rotation.y += 0.0004;
    updateSun();

    controls.update();
    renderer.render(scene, camera);
  }

  animate();
</script>
</body>
</html>
