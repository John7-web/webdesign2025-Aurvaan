<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>3D Sun Simulator with Smooth Switching</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      min-height: 100%;
      overflow-x: hidden;
      background: #000;
      color: #ddd;
      font-family: system-ui, sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* 3D viewer container */
    #viewer {
      width: 100%;
      height: 60vh;
      min-height: 420px;
      position: relative;
      background: radial-gradient(ellipse at center, #160804 0%, #000 60%);
      overflow: hidden;
      transition: height 360ms ease;
    }

    #info {
      position: absolute;
      bottom: 40px;
      left: 50%;
      transform: translateX(-50%);
      color: #ccc;
      font-size: 13px;
      opacity: 0.95;
      z-index: 10;
      text-align: center;
      pointer-events: none;
    }

    #buttons {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
    }

    #buttons button {
      margin: 0 5px;
      padding: 5px 10px;
      font-size: 14px;
    }

    /* Research / content area */
    #content {
      max-width: 920px;
      margin: 24px auto 72px;
      padding: 20px 22px;
      background: rgba(255,255,255,0.02);
      border-radius: 8px;
      box-shadow: 0 6px 30px rgba(0,0,0,0.6);
      color: #ddd;
      line-height: 1.6;
    }

    #content h1, #content h2 { color: #fff; margin: 0.8rem 0 0.4rem; }
    #content p, #content ul { margin: 0.5rem 0; color: #cfd8dc; }
    #content ul { padding-left: 1.2rem; }
    #content small { color: #9ea7ab; }
  </style>
</head>
<body>
<div id="viewer">
  <div id="info">Realistic Sun Simulator</div>
  <div id="buttons">
    <button onclick="switchSun(0)">Yellow Dwarf Star</button>
    <button onclick="switchSun(1)">Red Dwarf Star</button>
    <button onclick="switchSun(2)">Blue Giant Star</button>
  </div>
</div>

<div id="content">
  <h1>Sun — In-depth Overview</h1>
  <p>The Sun is a G-type main-sequence star (G2V) at the center of our Solar System and the primary source of energy for Earth. Below is an overview of the Sun's structure, energy production, magnetic activity, solar wind, and its influence on the Solar System.</p>

  <h2>Formation & Evolution</h2>
  <p>The Sun formed about 4.6 billion years ago by gravitational collapse of a region in a molecular cloud. It is currently in the stable hydrogen-burning phase (main sequence) and will eventually evolve into a red giant before shedding outer layers and leaving a white dwarf.</p>

  <h2>Internal Structure & Energy</h2>
  <p>The Sun's internal layers include the core (where nuclear fusion of hydrogen to helium powers the star), the radiative zone (energy transport via photons), and the convective zone (bulk motion transports energy to the surface).</p>

  <h2>Photosphere, Chromosphere & Corona</h2>
  <p>The visible surface is the photosphere; above it lie the chromosphere and the hot, tenuous corona. The corona extends far into space and is the source of the solar wind and coronal mass ejections (CMEs).</p>

  <h2>Magnetic Activity</h2>
  <p>The Sun's magnetic field drives sunspots, flares, and CMEs which can influence space weather and affect Earth’s magnetosphere, satellites, and power grids.</p>

  <h2>Solar Wind & Influence</h2>
  <p>The solar wind is a supersonic plasma flow from the corona that shapes planetary magnetospheres and contributes to phenomena such as aurorae. The heliosphere formed by solar wind surrounds the Solar System.</p>

  <h2>Stellar Types & Life Cycle</h2>
  <p>Stars are classified by temperature and spectral type. The Sun is a relatively stable, middle-aged star; other stars (red dwarfs, giants, blue supergiants) have different lifetimes and influence on their systems.</p>

  <h2>Quick Facts</h2>
  <ul>
    <li>Spectral type: G2V</li>
    <li>Mean radius: ~696,340 km</li>
    <li>Mass: ~1.989 × 10<sup>30</sup> kg</li>
    <li>Surface temperature (photosphere): ~5,780 K</li>
  </ul>

  <p><small>Sources: NASA Solar Dynamics Observatory, ESA, peer-reviewed heliophysics literature.</small></p>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.124.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.124.0/examples/js/controls/OrbitControls.js"></script>

<script>
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 5000);
camera.position.set(0, 2, 10);

const viewer = document.getElementById('viewer');

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(viewer.clientWidth, viewer.clientHeight);
renderer.setPixelRatio(window.devicePixelRatio);
renderer.outputEncoding = THREE.sRGBEncoding;
renderer.domElement.style.display = 'block';
viewer.appendChild(renderer.domElement);

// Ensure camera uses viewer aspect ratio
camera.aspect = viewer.clientWidth / viewer.clientHeight;
camera.updateProjectionMatrix();

const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;

scene.add(new THREE.AmbientLight(0x222222));
const sunLight = new THREE.PointLight(0xffffff, 5, 0);
scene.add(sunLight);

const loader = new THREE.TextureLoader();

const sunTextures = [
  'https://tse2.mm.bing.net/th/id/OIP.fOOoRbs8pnLd1mYP1HfeHwHaDt?rs=1&pid=ImgDetMain&o=7&rm=3',
  'https://cdn.mos.cms.futurecdn.net/6DxQN3KLyEAMjsF5i5GNAL-320-80.png', // Red Dwarf texture
  'https://th.bing.com/th/id/OIP.MZnPDCFiIJSOt_Z2oJOBzQHaDt?o=7rm=3&rs=1&pid=ImgDetMain&o=7&rm=3' // Blue Giant texture online
];

let sun = createSun(sunTextures[0], 3);
let targetTextureIndex = 0;
let transitionProgress = 1;
let oldSun = null;

function createSun(textureURL, size) {
  const tex = loader.load(textureURL);
  const radius = size !== undefined ? size : 3;
  const mesh = new THREE.Mesh(
    new THREE.SphereGeometry(radius, 128, 128),
    new THREE.MeshStandardMaterial({
      map: tex,
      emissive: 0xffffff,
      emissiveMap: tex,
      emissiveIntensity: 2,
      roughness: 0.1,
      metalness: 0.0,
      transparent: true
    })
  );
  scene.add(mesh);
  sunLight.position.copy(mesh.position);
  return mesh;
}

function switchSun(index) {
  if(index === targetTextureIndex) return;
  oldSun = sun;
  targetTextureIndex = index;
  // Make Red Dwarf smaller, Blue Giant larger
  let size = 3;
  if(index === 1) size = 1.5;
  if(index === 2) size = 4.5;
  sun = createSun(sunTextures[index], size);
  transitionProgress = 0;
}

// Stars background
const starsGeo = new THREE.BufferGeometry();
const positions = new Float32Array(12000 * 3);
for (let i = 0; i < positions.length; i++) positions[i] = (Math.random() - 0.5) * 4000;
starsGeo.setAttribute('position', new THREE.BufferAttribute(positions, 3));
scene.add(new THREE.Points(starsGeo, new THREE.PointsMaterial({ size: 0.7, color: 0xffffff })));

function animate() {
  requestAnimationFrame(animate);

  sun.rotation.y += 0.0005;
  if(oldSun && transitionProgress < 1) {
    transitionProgress += 0.1;
    sun.material.opacity = transitionProgress;
    oldSun.material.opacity = 1 - transitionProgress;
    if(transitionProgress >= 1) {
      scene.remove(oldSun);
      oldSun = null;
    }
  }

  controls.update();
  renderer.render(scene, camera);
}

animate();

window.addEventListener('resize', () => {
  renderer.setSize(viewer.clientWidth, viewer.clientHeight);
  camera.aspect = viewer.clientWidth / viewer.clientHeight;
  camera.updateProjectionMatrix();
});
</script>
</body>
</html>
